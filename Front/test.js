import fs from 'fs';

const getAdidas = async (id) => {
    const headers = {
        'Accept-Language': 'es-419,es;q=0.9',
		'User-Agent': 'Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/116.0.0.0 Safari/537.36 Edg/116.0.1938.54'
    };

    try {
        const response = await fetch(`https://www.adidas.cl/api/products/${id}`, { headers });

        if (!response.ok) {
            console.log('Error: ' + response.statusText);
            return;
        }

        const data = await response.json();
        return data;

    } catch (error) {
        console.log(error.message);
    }
};

const array = [	"HD6771",
"HM6237",
"IC2375",
"HM4040",
"GZ3572",
"GW4557",
"GY9350",
"IG9682",
"IC1545",
"HI5236",
"IK4026",
"HM1913",
"IN4244",
"IC5316",
"HT5438",
"IL4969",
"GX2005",
"GW9745",
"EG2042",
"HZ6247",
"H06117",
"IG7373",
"HA6609",
"GW2955",
"HM9259",
"IB8492",
"IE9755",
"GZ2451",
"IJ6823",
"IC6682",
"HD8973",
"II5605",
"HT5016",
"GZ5235",
"GW9096",
"HZ8273",
"IE7726",
"GX4466",
"HZ1531",
"IM4941",
"GX4586",
"IB2035",
"GY6465",
"IM4259",
"GX9603",
"IE2293",
"GZ9261",
"GY9244",
"FZ6199",
"IE1843",
"HQ1045",
"GW9381",
"HQ7080",
"ID5403",
"HQ1838",
"GX4279",
"GV8053",
"IC6488",
"IA3141",
"H44789",
"HQ6339",
"H18017",
"HL6618",
"HR5442",
"EK0315",
"GX1728",
"HA8339",
"IE4971",
"GY2566",
"HQ6351",
"GX4414",
"HQ3698",
"GY9518",
"HN5739",
"HT4713",
"IR8487",
"GZ5045",
"IK4047",
"HL8660",
"HY2704",
"GX8433",
"IG7317",
"HD1301",
"GZ0674",
"GW4847",
"HQ6174",
"IB2041",
"IF5335",
"IE0235",
"HT9414",
"II0910",
"GC6165",
"HE6741",
"IG9678",
"H64211",
"FZ6152",
"HC6637",
"GV6020",
"GL0566",
"HA7552",
"GZ8858",
"B22706",
"HM1908",
"IC6083",
"IF2559",
"GY9049",
"IC5720",
"HY5528",
"GZ1728",
"IL2417",
"IE4957",
"HE0308",
"HQ4275",
"HT2110",
"280647",
"IC5278",
"GV7685",
"HQ4461",
"HS1185",
"GW6721",
"GZ6412",
"IB5913",
"HI3630",
"GX6984",
"ID1853",
"IE2298",
"H65782",
"IB8768",
"GZ9378",
"GY9853",
"H57761",
"HQ6859",
"EF8472",
"FW5803",
"HQ2171",
"HP5928",
"HP2742",
"IN4247",
"HP7560",
"HP6102",
"H00647",
"IA6446",
"IC8785",
"HN5465",
"HQ1345",
"G58109",
"FZ6273",
"IA2999",
"HA0071",
"HQ4649",
"GZ5174",
"ID0034",
"FX6883",
"GK5265",
"HQ8866",
"GZ2841",
"IN4248",
"IG9679",
"GY6793",
"H06258",
"IC2376",
"HQ4447",
"GX4608",
"GY9351",
"GZ6355",
"HP8644",
"IG5285",
"GZ6682",
"HP8716",
"HD3929",
"HP2083",
"HK5056",
"IN4251",
"FY8098",
"GZ6744",
"GW4657",
"HQ8941",
"HR1783",
"IC5416",
"GZ9379",
"IA3429",
"IE9969",
"HQ3978",
"HE9058",
"HQ6248",
"IA6461",
"ID2177",
"HL8675",
"HR5426",
"HS7543",
"IE2301",
"FZ5706",
"HQ8536",
"HP8725",
"IF0044",
"IF0042",];

let promises = array.map(id => getAdidas(id));

Promise.all(promises)
    .then((data) => {
        // Elimina los elementos undefined del array (si la funciÃ³n getAdidas devuelve undefined)
        data = data.filter(item => item !== undefined);
        fs.writeFileSync('output.json', JSON.stringify(data, null, 2)); 
        console.log('Data saved in output.json');
    })
    .catch(error => console.error(error));
